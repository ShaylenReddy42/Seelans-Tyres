parameters:
- name: buildConfiguration
  type: string

- name: solutionFolder
  type: string

- name: project
  type: string

- name: workDir
  type: string

steps:
- script: dotnet publish -c ${{ parameters.buildConfiguration }} -r win-x64 --no-self-contained
  displayName: 'Publish ${{ parameters.project }}'
  workingDirectory: '${{ parameters.workDir }}\${{ parameters.solutionFolder }}\${{ parameters.project }}'

- task: ArchiveFiles@2
  displayName: 'Archive ${{ parameters.project }}'
  inputs:
    rootFolderOrFile: '${{ parameters.workDir }}\${{ parameters.solutionFolder }}\${{ parameters.project }}\publish'
    includeRootFolder: false
    archiveType: zip
    archiveFile: '$(Build.ArtifactStagingDirectory)\${{ parameters.project }}.zip'
